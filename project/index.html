<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="stylesheet" href="custom.css"/>
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
		<!-- Live2D -->
		<script src="./js/live2d.min.js"></script>
		<script src="./js/live2d_core.min.js"></script>
		<!-- PixiJS -->
		<script src="./js/pixi.min.js"></script>
		<script src="./js/pixi_index.js"></script>
		<!-- Mediapipe -->
		<script src="./js/face.js"></script>
		<script src="./js/draw.js"></script>
		<script src="./js/cam.js"></script>
		<!-- Kalidokit -->
		<script src="./js/kalido.js"></script>
		<link rel="manifest" href="./app/manifest.webmanifest">
		<script>
			if ('serviceWorker' in navigator) {
			  window.addEventListener('load', () => {
				navigator.serviceWorker.register('./app/sw.js')
				  .then(registration => {
					console.log('Service Worker registered:', registration);
				  })
				  .catch(error => {
					console.log('Service Worker registration failed:', error);
				  });
			  });
			}
		  </script>
	</head>
	<body>
		
		<!-- Preview -->
		<div id="preview" style="display: none;">
			<video id="my-video"></video>
			<canvas id="my-guides"></canvas>
		</div>
		<video id="bg-video" autoplay></video>
		<span id="video-statement" style="position: absolute; bottom: 2px; right: 2px;"></span>
		<!-- Live2D -->
		<canvas id="my-live2d"></canvas>
		<div class="setting-icon" id="set" onclick="modalSet()">
			<span class="material-symbols-outlined set">
				settings
			</span>
		</div>
		<img id="desk" src="https://yt.kame-ta.f5.si/project/img/desk.png">
		<img id="mic" src="https://yt.kame-ta.f5.si/project/img/mic.png">
		<div class="modal" id="modal1">
			<div style="display: none;">
<video id="cv-video" width="320" height="180" controls></video><hr>
<button id="start-recording">Start Recording</button>
<button id="stop-recording">Stop Recording</button><br>
<a id="download-link" download="recorded-video.mp4" style="display: block;">Download Video</a>
			</div>
			<br>
			<br>
			<hr>
			<button id="rec-start">Start Recording</button>
			<button id="rec-stop">Stop & Download</button>
			<hr>
			<br>
			<br>
			  <select id="sourceSelect">
				    <option value="none">選択しない</option>
					    <option value="file">ファイルから</option>
						    <option value="camera">カメラから</option>
							  </select>
							    <select id="cameraSelect" style="display:none;"></select>
								  <input type="file" id="fileInput" accept="video/*" style="display:none;">
								  <select id="v-set">
									<option value="true">video mute</option>
									<option value="false">video not mute</option>
								  </select>
				<p>desk.png<br>
				left:<input type="range" min="-500" max="4800" id="deskLeftSet">
				<br>
				<input type="number" onchange="SetNum('desk', 'deskLeft', 'deskLeftSet', 1)" id="deskLeft" class="num"></input>px<br>
				top:<input type="range" min="-500" max="4800" id="deskTopSet">
				<br>
				<input type="number" onchange="SetNum('desk', 'deskTop', 'deskTopSet', 0)" id="deskTop" class="num"></input>px
				<br>width:<input type="range" min="0" max="4800" id="deskSize">
				<br>
				<input type="number" onchange="SetNum('desk', 'deskValue', 'deskSize', 2)" id="deskValue" class="num"></input>px
			</p>
			<hr>
			<p>mic.png<br>
				left:<input type="range" min="-500" max="4800" id="micLeftSet">
				<br>
				<input type="number" onchange="SetNum('mic', 'micLeft', 'micLeftSet', 1)" id="micLeft" class="num"></input>px
				<br>top:<input type="range" min="-500" max="4800" id="micTopSet">
				<br>
				<input type="number" onchange="SetNum('mic', 'micTop', 'micTopSet', 0)" id="micTop" class="num"></input>px
				<br>width:<input type="range" min="0" max="4800" id="micSize">
				<br>
				<input type="number" onchange="SetNum('mic', 'micValue', 'micSize', 2)" id="micValue" class="num"></input>px
			</p>
			<hr>
			<button onclick="document.getElementById('modal1').style.display='none';">Close</button>
			<br>
			<input type="range" id="model-size" min="-0.5" max="10" step="0.001" value="1">
			<br>
			<p><input type="number" id="current-size" onchange="setTimeout(() => {document.getElementbyId('model-size').value = document.getElementById('current-size').value}, 100);">px</p>
			<br>
			<strong style="color: white;"><a href="./retina.html">Retina display ver</a></strong>
			<br><hr>
			<br><br>
			<hr>
			<button onclick="setValueInfo()">RESET</button>
			<script type="module" src="main.js"></script>
			<script src="./script.js"></script>
			<script src="./video.js"></script>
			<script src="./record.js"></script>
		</div>
	</body>
</html>
